generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model log {
  action       String   @db.VarChar
  game_room_id String   @db.VarChar
  player_id    String
  data         String
  created_at   DateTime @default(now()) @db.Timestamptz(6)
  game         game     @relation(fields: [game_room_id], references: [room_id], onDelete: Cascade)
  player       player   @relation(fields: [player_id], references: [player_id], onDelete: Cascade)

  @@id([game_room_id, player_id, created_at])
}

model player {
  player_id       String            @id @default(cuid())
  display_name    String            @db.VarChar
  joined_at       DateTime?         @default(now()) @db.Timestamptz(6)
  game_room_id    String            @db.VarChar
  is_party_leader Boolean           @default(false)
  log             log[]
  game            game              @relation(fields: [game_room_id], references: [room_id], onDelete: Cascade)
  player_sequence player_sequence[]
}

model player_sequence {
  game_room_id      String    @id @db.VarChar
  created_at        DateTime? @default(now()) @db.Timestamptz(6)
  current_player_id String
  player            player    @relation(fields: [current_player_id], references: [player_id], onDelete: Cascade)
  game              game      @relation(fields: [game_room_id], references: [room_id], onDelete: Cascade)
}

model game {
  room_id         String           @id @default("") @db.VarChar
  status          String           @db.VarChar
  room_created_at DateTime         @default(now()) @db.Timestamptz(6)
  log             log[]
  player          player[]
  player_sequence player_sequence?

  @@map(" game")
}

/// We could not retrieve columns for the underlying table. Either it has none or you are missing rights to see them. Please check your privileges.
// model message {
// }
